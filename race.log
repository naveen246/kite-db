Tx B: request xLock on block 2
Tx B: receive xLock on block 2
Tx A: request sLock on block 1
Tx A: receive sLock on block 1
Tx C: request xLock on block 1
Tx C: receive xLock on block 1
Tx B: request sLock on block 1
Tx A: request sLock on block 2
Tx B: receive sLock on block 1
Tx A: receive sLock on block 2
==================
WARNING: DATA RACE
Read at 0x00c00020c1a0 by goroutine 9:
  runtime.racereadrange()
      <autogenerated>:1 +0x14
  internal/poll.(*FD).Pwrite()
      /opt/homebrew/Cellar/go/1.22.1/libexec/src/internal/poll/fd_unix.go:416 +0x22c
  os.(*File).pwrite()
      /opt/homebrew/Cellar/go/1.22.1/libexec/src/os/file_posix.go:54 +0x2f0
  os.(*File).WriteAt()
      /opt/homebrew/Cellar/go/1.22.1/libexec/src/os/file.go:226 +0x2c4
  github.com/naveen246/kite-db/file.(*FileMgr).Write()
      /Users/naveen/projects/go_projects/kitedb/kite-db/file/file_mgr.go:74 +0x1b4
  github.com/naveen246/kite-db/wal.(*Log).flush()
      /Users/naveen/projects/go_projects/kitedb/kite-db/wal/wal.go:156 +0x8c
  github.com/naveen246/kite-db/wal.(*Log).Flush()
      /Users/naveen/projects/go_projects/kitedb/kite-db/wal/wal.go:167 +0x48
  github.com/naveen246/kite-db/txn.(*RecoveryMgr).commit()
      /Users/naveen/projects/go_projects/kitedb/kite-db/txn/recovery.go:24 +0xa8
  github.com/naveen246/kite-db/txn.(*Transaction).Commit()
      /Users/naveen/projects/go_projects/kitedb/kite-db/txn/transaction.go:48 +0x40
  github.com/naveen246/kite-db/txn_test.TestConcurrency.func2()
      /Users/naveen/projects/go_projects/kitedb/kite-db/txn/concurrency_test.go:52 +0x2e4

Previous write at 0x00c00020c1a0 by goroutine 8:
  runtime.slicecopy()
      /opt/homebrew/Cellar/go/1.22.1/libexec/src/runtime/slice.go:325 +0x0
  github.com/naveen246/kite-db/file.(*Page).SetInt()
      /Users/naveen/projects/go_projects/kitedb/kite-db/file/page.go:68 +0x19c
  github.com/naveen246/kite-db/wal.(*Log).saveLastRecordPos()
      /Users/naveen/projects/go_projects/kitedb/kite-db/wal/wal.go:141 +0x2c
  github.com/naveen246/kite-db/wal.(*Log).Append()
      /Users/naveen/projects/go_projects/kitedb/kite-db/wal/wal.go:120 +0x1f4
  github.com/naveen246/kite-db/txn.WriteCommitRecToLog()
      /Users/naveen/projects/go_projects/kitedb/kite-db/txn/wal_record.go:178 +0x428
  github.com/naveen246/kite-db/txn.(*RecoveryMgr).commit()
      /Users/naveen/projects/go_projects/kitedb/kite-db/txn/recovery.go:23 +0x8c
  github.com/naveen246/kite-db/txn.(*Transaction).Commit()
      /Users/naveen/projects/go_projects/kitedb/kite-db/txn/transaction.go:48 +0x40
  github.com/naveen246/kite-db/txn_test.TestConcurrency.func1()
      /Users/naveen/projects/go_projects/kitedb/kite-db/txn/concurrency_test.go:35 +0x2dc

Goroutine 9 (running) created at:
  github.com/naveen246/kite-db/txn_test.TestConcurrency()
      /Users/naveen/projects/go_projects/kitedb/kite-db/txn/concurrency_test.go:40 +0x618
  testing.tRunner()
      /opt/homebrew/Cellar/go/1.22.1/libexec/src/testing/testing.go:1689 +0x180
  testing.(*T).Run.gowrap1()
      /opt/homebrew/Cellar/go/1.22.1/libexec/src/testing/testing.go:1742 +0x40

Goroutine 8 (running) created at:
  github.com/naveen246/kite-db/txn_test.TestConcurrency()
      /Users/naveen/projects/go_projects/kitedb/kite-db/txn/concurrency_test.go:23 +0x4d4
  testing.tRunner()
      /opt/homebrew/Cellar/go/1.22.1/libexec/src/testing/testing.go:1689 +0x180
  testing.(*T).Run.gowrap1()
      /opt/homebrew/Cellar/go/1.22.1/libexec/src/testing/testing.go:1742 +0x40
==================
Tx B: commit
Tx A: commit
Tx C: request sLock on block 2
Tx C: receive sLock on block 2
Tx C: commit
--- FAIL: TestConcurrency (0.71s)
    testing.go:1398: race detected during execution of test
FAIL
FAIL	github.com/naveen246/kite-db/txn	1.305s
FAIL